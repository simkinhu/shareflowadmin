import{a as C,u as b,_ as B,b as N,c as q,g as h,d as I,i as T}from"../index-9lME9WWa.js";import{_,a as g}from"./Label.vue_vue_type_script_setup_true_lang-BWoSaepq.js";import{u as E}from"./useConfigStore-BM64SnVO.js";import{a as r}from"./ant-design-vue-CyiF9e54.js";import{d as L,r as n,q as R,j as x,k as S,c as a,_ as s,u as t,ac as d,aa as j,a4 as M,l as c}from"./@vue-Ca6oPw20.js";import"./pinia-R2irzhdd.js";import"./@vueuse-BnZciM7y.js";import"./axios-DTyqpfTh.js";import"./@multiavatar-dxrVjIoY.js";import"./crypto-js-l0AFIALE.js";import"./class-variance-authority-Bb4qSo10.js";import"./clsx-B-dksMZM.js";import"./tailwind-merge-BkWO730n.js";import"./radix-vue-B6u9mWk8.js";import"./@floating-ui-DW8MF69D.js";import"./@radix-icons--IQtXok_.js";import"./@iconify-DzGEP68A.js";import"./lucide-vue-next-BGOoG6k-.js";import"./@ant-design-C6rk-XVk.js";import"./@ctrl-DOFZgDuz.js";import"./vue-router-Dial6ibt.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./@babel-BiFW4_mA.js";import"./lodash-es-D9ej4-U1.js";import"./vue-types-C5fUfLeo.js";import"./dom-align-CRCehRfe.js";import"./@emotion-BtrR-yrm.js";import"./stylis-DsJDcYJc.js";const z={class:"lg:min-h-[934px] xm:py-8 inline-flex items-center justify-center"},D={key:0,class:"mt-3 text-sm text-green-600 w-[320px]"},F={class:"grid gap-4"},H={class:"grid gap-2"},G={class:"grid gap-2"},J={class:"grid gap-2"},Ve=L({__name:"reg",setup(K){const V=C(),{setActiveTab:v}=V;b();const m=E(),i=n(""),l=n(""),p=n(""),w=n(""),f=n(0),y=n(!1);R(async()=>{if(await m.loadSettingsFromAPI(),f.value=Number(m.getSetting("new_user_days")),m.getSetting("paymentSwitch")){const e=new URL(window.location.href).hostname,o=m.getSetting("domainAddress"),P=m.getSetting("navSwitchAll");y.value=e===o||P===!1}const u=new URLSearchParams(window.location.search);w.value=u.get("share")||""});const A=()=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.value)?l.value.length<8?(r.warning("用户密码不得小于8位字符，请重新输入"),!1):l.value!==p.value?(r.warning("两次输入的密码不一致"),!1):!0:(r.warning("请输入有效的电子邮箱"),!1),U=()=>{A()&&$()},$=()=>{const u=window.VITE_API_BASE_URL;T.post(u+"/app/user/regeister",{email:i.value,password:l.value,invcode:w.value}).then(e=>{if(e.data.data.code===201){r.success(e.data.data.msg),v("login"),l.value="",i.value="";return}if(e.data.data.code===401){r.warning(e.data.data.msg);return}if(e.data.data.code===400){r.warning(e.data.data.msg),i.value="";return}}).catch(e=>{console.error("请求错误:",e),r.error("操作失败，请稍后重试")})},k=()=>{v("login")};return(u,e)=>(x(),S("div",z,[a(t(I),{class:"mx-auto w-full"},{default:s(()=>[a(t(B),null,{default:s(()=>[a(t(N),{class:"text-2xl"},{default:s(()=>[d("开始注册")]),_:1}),f.value>=0?(x(),S("div",D," 新用户注册立即赠送"+j(f.value)+"天普通会员资格 ",1)):M("",!0)]),_:1}),a(t(q),null,{default:s(()=>[c("div",F,[c("div",H,[a(t(_),{for:"email"},{default:s(()=>[d("您的邮箱")]),_:1}),a(t(g),{id:"email",modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=o=>i.value=o),type:"email",placeholder:"helloai@example.com",required:""},null,8,["modelValue"])]),c("div",G,[a(t(_),{for:"password"},{default:s(()=>[d("设置密码")]),_:1}),a(t(g),{id:"password",modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value=o),type:"password",placeholder:"****************",required:""},null,8,["modelValue"])]),c("div",J,[a(t(_),{for:"confirmPassword"},{default:s(()=>[d("确认密码")]),_:1}),a(t(g),{id:"confirmPassword",modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=o=>p.value=o),type:"password",placeholder:"****************",required:""},null,8,["modelValue"])]),a(t(h),{onClick:U,type:"submit",class:"w-full"},{default:s(()=>[d(" 立即注册 ")]),_:1}),a(t(h),{onClick:k,variant:"outline",class:"w-full"},{default:s(()=>[d(" 已有账户？去登录 ")]),_:1})])]),_:1})]),_:1})]))}});export{Ve as default};
