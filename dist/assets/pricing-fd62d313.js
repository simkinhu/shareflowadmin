import{u as H}from"./usershare-32ed4ae5.js";import{a as M}from"./axios-fa38e072.js";import{l as ie}from"./loginChat-fb384daf.js";import{u as ce}from"./index-21098135.js";import{m as g,M as ue}from"./ant-design-vue-a7ef973d.js";import{d as de,c as e,a4 as _,W as n,X as w,Y as t,bn as pe,$ as s,r as d,w as _e,o as me,l as fe,_ as f,u as h,a3 as p,G as b,a2 as S,F as P,a5 as R,aV as he,a1 as ge}from"./@vue-c9a03ce3.js";import{h as ve}from"./@ant-design-32a4e489.js";import{_ as ye}from"./_plugin-vue_export-helper-c27b6911.js";import{s as T,z as k,i as ke,b as E,D as j,n as we,f as xe,e as Ce,k as Y}from"./vuetify-3df09d96.js";import"./pinia-2f8cef2e.js";import"./vue-demi-71ba0ef2.js";import"./@multiavatar-b28f2a65.js";import"./crypto-js-74ece96e.js";import"./vue-router-fcb76a2b.js";import"./dayjs-c0c7802c.js";/* empty css             */import"./vue3-perfect-scrollbar-5de46532.js";import"./perfect-scrollbar-c9c56521.js";import"./vue3-apexcharts-a5217f6c.js";import"./vue-d2c16750.js";import"./apexcharts-a35677a7.js";import"./vue-tabler-icons-cf6f1e0c.js";/* empty css                      */import"./v-calendar-ef2113f4.js";import"./@popperjs-e3d1f27d.js";import"./maska-ce45910f.js";import"./vue3-easy-data-table-7f7218d8.js";import"./core-js-147366a5.js";import"./vue-i18n-d9e40cc6.js";import"./@intlify-8623a1ec.js";import"./vue-scrollto-aaefc7e1.js";import"./vue-easy-lightbox-eec5a43b.js";import"./@babel-86619d60.js";import"./@ctrl-044b369f.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./@emotion-f7664732.js";import"./stylis-5efc5547.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-ef06c517.js";import"./dom-align-529d0cdc.js";import"./lodash-es-5af3e9d7.js";import"./async-validator-dee29e8b.js";import"./throttle-debounce-87e7e444.js";const be="/list/assets/profilebg-44563d8e.jpg",Se=de({setup(){return{userStore:H()}},data(){return{usercdkInput:""}},methods:{cdkModeluse(){if(!this.userStore.isLogin)return g.warning("请先登录，再进行卡密兑换"),!1;let r=this.usercdkInput;if(!r||!/^[a-zA-Z0-9]+$/.test(r)){g.warning("请输入正确的兑换码，您输入的兑换码类型有误！");return}ue.confirm({title:()=>"使用提醒：",icon:()=>e(ve),content:()=>"您确定使用该兑换码进行激活吗？该兑换码使用过后不可再次使用！",centered:!0,onOk:()=>{const x=window.VITE_API_BASE_URL;M.post(x+"/app/user/cdkeyus",{cdkcode:r},{withCredentials:!0}).then(o=>{const v=o.data.data;v.code==200?(this.userStore.CdkeyModal=!1,g.success(v.msg,5),this.usercdkInput=""):v.code===400&&g.error(v.msg)}).catch(o=>{console.log(o)})},onCancel(){return g.warning("您已取消兑换码使用，如需使用请提交兑换！"),!1},zIndex:99999999})}}});function Ie(r,m,x,o,v,F){const y=_("a-alert"),A=_("a-input"),B=_("a-modal");return n(),w(B,{style:{top:"40%"},"z-index":"1009",footer:null,open:r.userStore.CdkeyModal,"onUpdate:open":m[2]||(m[2]=i=>r.userStore.CdkeyModal=i),width:"350px",title:"CDKEY兑换开通"},{default:t(()=>[e(y,{class:"mt-3",message:"请输入您的CDKEY兑换码进行兑换",type:"warning"}),e(A,{class:"mt-5",value:r.usercdkInput,"onUpdate:value":m[0]||(m[0]=i=>r.usercdkInput=i),placeholder:"请输入您的CDKEY兑换码",onKeyup:pe(r.cdkModeluse,["enter"])},null,8,["value","onKeyup"]),s("button",{class:"mt-5 loginbutton",onClick:m[1]||(m[1]=(...i)=>r.cdkModeluse&&r.cdkModeluse(...i))},"立即使用")]),_:1},8,["open"])}const Ae=ye(Se,[["render",Ie]]);const Be=["src"],Le={class:"text-center top-spacer"},Ue={class:"avatar-border"},Me=["innerHTML"],Ve={key:0,class:"text-h5 mt-5"},ze=b("点击登录"),Pe={key:1,class:"mt-6"},Te=s("span",{class:"text-h6 font-weight-regular"},"UserToken",-1),Ee={class:"text-h5"},Fe={class:"px-4 py-1"},De=s("h6",{class:"text-h6 mt-1"},"会员类型",-1),Ke={key:0,class:"mt-1"},$e=s("h6",{class:"text-h6 mt-1"},"对话窗口",-1),qe={class:"text-h6 mt-2"},Ne=s("h6",{class:"text-h6 mt-1"},"会员到期",-1),Re={class:"text-h6 mt-2"},je=s("h6",{class:"text-h6 mt-1"},"注册时间",-1),Ye={class:"text-h6 mt-2"},He=s("h6",{class:"text-h6 mt-1"},"最后登录",-1),Oe={class:"text-h6 mt-2"},We={class:"d-flex justify-space-between"},Ge=["textContent"],Je=["src"],Xe={class:"d-flex align-center mt-4"},Ze={key:0,class:"text-h6 mt-n3 pr-2"},Qe={key:1,class:"display-1"},et={key:2,class:"text-medium-emphasis font-weight-medium mt-4 ml-2"},tt={key:3,class:"text-medium-emphasis font-weight-medium ml-2"},st=b("立即购买"),ot=b("立即兑换"),at=s("h4",null,"请使用手机打开微信扫一扫",-1),nt=s("h3",{style:{"font-weight":"bold"}},"使用微信支付开通Plus会员",-1),lt={key:1,style:{width:"160px",height:"160px",padding:"60px 0",margin:"0 auto"}},rt=b("点击新窗口支付"),it=s("h4",null,"请使用手机打开支付宝扫一扫",-1),ct=s("h3",{style:{"font-weight":"bold"}},"使用支付宝支付开通Plus会员",-1),es={setup(r){const m=ce(),x=d("1"),o=H(),v=d([]),F=d(!1),y=d(!1),A=d(null),B=d(null),i=d(null),V=d(null),L=d(!0),I=d(!1),O=d(String(m.getSetting("siteTitle")||"")),W=async()=>{try{const a=window.VITE_API_BASE_URL,l=await M.post(`${a}/app/user/svip`);v.value=l.data.data}catch(a){console.error("请求错误:",a)}},G=()=>{o.loginModal=!0},D=()=>{const a=navigator.userAgent.toLowerCase();return/mobile|android|touch|webos|hpwos/.test(a)?"mobile":"pc"},K=async a=>{try{const l=window.VITE_API_BASE_URL,c=await M.post(`${l}/app/user/pay`,{paytype:a,package_id:$.value,device_type:D()},{withCredentials:!0});if(c.data.data.type==="error")return g.warn("支付错误请联系管理员："+c.data.data.msg,5),!1;c.data.data.type==="qrcode"?a==="1"?A.value=c.data.data.codeurl:a==="2"&&D()==="pc"&&(B.value=c.data.data.codeurl,L.value=!0):c.data.data.type==="url"&&(V.value=c.data.data.payurl,L.value=!1);const C=c.data.data.orderno;clearInterval(i.value),X(C)}catch(l){console.error("请求错误:",l)}},J=()=>{V.value&&window.open(V.value,"_blank")},X=a=>{i.value=setInterval(()=>{Z(a)},2e3)},Z=async a=>{try{const l=window.VITE_API_BASE_URL;(await M.post(`${l}/app/user/paystatus`,{orderno:a},{withCredentials:!0})).data.data.code==="ok"?(clearInterval(i.value),g.success("支付成功，已为您开通对应会员资格"),o.fetchUserData(o.userToken),y.value=!1):console.log("Payment not completed yet.")}catch(l){console.error("请求错误:",l)}},$=d(0),z=d(0),Q=a=>{if($.value=a.id,z.value=a.package_price,!o.isLogin)return g.warning("您还未登录，请先登录"),o.loginModal=!0,!1;y.value=!0,K(x.value)},ee=()=>{o.CdkeyModal=!0},te=a=>{x.value=a,y.value&&K(a)};return _e(y,a=>{!a&&i.value&&clearInterval(i.value)}),me(()=>{if(W(),o.fetchUserData(null),document.title=O.value,JSON.parse(localStorage.getItem("isLogin")||"false")||(g.warning("您还未登录，清先登录！"),o.loginModal=!0),m.getSetting("paymentSwitch")){const l=new URL(window.location.href).hostname,c=m.getSetting("domainAddress"),C=m.getSetting("navSwitchAll");console.log(l),console.log(C),l===c||C===!1?I.value=!0:I.value=!1}}),fe(()=>{i.value&&clearInterval(i.value)}),(a,l)=>{const c=_("crown-icon"),C=_("message-circle-icon"),se=_("calendar-event-icon"),oe=_("history-icon"),ae=_("calendar-time-icon"),q=_("a-qrcode"),N=_("a-tab-pane"),ne=_("a-button"),le=_("a-tabs"),re=_("a-modal");return n(),f(P,null,[e(j,{elevation:"10",class:"overflow-hidden"},{default:t(()=>[s("img",{src:h(be),alt:"profile",class:"w-100"},null,8,Be),s("div",null,[e(T,{class:"mt-1"},{default:t(()=>[e(k,{cols:"12",lg:"2",sm:"12",class:"d-flex justify-center order-sml-first"},{default:t(()=>[s("div",Le,[s("div",Ue,[e(ke,{size:"100",class:"userImage"},{default:t(()=>[s("div",{innerHTML:h(o).userAvatar,style:{width:"92px",height:"92px"}},null,8,Me)]),_:1})]),h(o).isLogin?(n(),f("div",Pe,[Te,s("h5",Ee,p(h(o).userToken),1)])):(n(),f("h5",Ve,[e(E,{class:"elevation-0",variant:"elevated",onClick:G},{default:t(()=>[ze]),_:1})]))])]),_:1}),e(k,{cols:"12",lg:"10",sm:"12",class:"order-sm-second pb-10"},{default:t(()=>[s("div",Fe,[e(T,{class:"justify-center"},{default:t(()=>[e(k,{cols:"12",sm:"6",md:"4",lg:"2",class:"text-center"},{default:t(()=>[e(c,{size:"30"}),De,h(o).isLogin?(n(),f("div",Ke,[e(E,{rounded:"md",class:"font-weight-bold",color:h(o).isPlus?"error":"success",size:"small",label:""},{default:t(()=>[b(p(h(o).isPlus?"Plus会员":"普通会员"),1)]),_:1},8,["color"])])):S("",!0)]),_:1}),e(k,{cols:"12",sm:"6",md:"4",lg:"2",class:"text-center"},{default:t(()=>[e(C,{size:"30"}),$e,s("h4",qe,p(h(o).userCount),1)]),_:1}),e(k,{cols:"12",sm:"6",md:"4",lg:"2",class:"text-center"},{default:t(()=>[e(se,{size:"30"}),Ne,s("h4",Re,p(h(o).expireTime),1)]),_:1}),e(k,{cols:"12",sm:"6",md:"4",lg:"2",class:"text-center"},{default:t(()=>[e(oe,{size:"30"}),je,s("h4",Ye,p(h(o).createTime),1)]),_:1}),e(k,{cols:"12",sm:"6",md:"4",lg:"2",class:"text-center"},{default:t(()=>[e(ae,{size:"30"}),He,s("h4",Oe,p(h(o).updateTime),1)]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1}),e(T,{class:"d-flex justify-center mt-8"},{default:t(()=>[(n(!0),f(P,null,R(v.value,u=>(n(),w(k,{cols:"12",md:"3",sm:"6",xl:"3",key:u.caption},{default:t(()=>[e(j,{elevation:"10",class:"rounded-md pa-sm-8 pa-4"},{default:t(()=>[s("div",We,[s("h2",{class:"text-medium-emphasis text-uppercase mb-6",textContent:p(u.package_name)},null,8,Ge),u.package_tag_status?(n(),w(E,{key:0,size:"small",class:"mt-sm-n4 font-weight-bold",color:"warning"},{default:t(()=>[b(p(u.package_tag),1)]),_:2},1024)):S("",!0)]),s("img",{src:u.package_image,width:"90",alt:"icon"},null,8,Je),s("div",Xe,[I.value?(n(),f("sup",Ze,"￥")):S("",!0),I.value?(n(),f("h2",Qe,p(u.package_price),1)):S("",!0),F.value?(n(),f("span",et,"/年")):(n(),f("span",tt,p(u.package_days)+"天",1))]),e(we,{class:"mb-0 pl-0 bg-transparent pt-5"},{default:t(()=>[(n(!0),f(P,null,R(u.listtitle,U=>(n(),w(xe,{class:"px-0",key:U.listtitle},{default:t(()=>[e(Ce,{class:"text-body-1 d-flex align-center font-weight-medium text-medium-emphasis"},{default:t(()=>[(n(),w(he(U.feature_icon),{class:ge(["text-"+U.feature_color,"mr-4"]),"stroke-width":"2",size:"18"},null,8,["class"])),b(" "+p(U.feature_title),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024),I.value?(n(),w(Y,{key:0,color:"primary",size:"large",class:"mt-6",flat:"",block:"",onClick:()=>Q(u)},{default:t(()=>[st]),_:2},1032,["onClick"])):(n(),w(Y,{key:1,color:"primary",size:"large",class:"mt-6",flat:"",block:"",onClick:ee},{default:t(()=>[ot]),_:1}))]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(re,{bodyStyle:"paybox","z-index":"9999",footer:null,centered:"true",open:y.value,"onUpdate:open":l[1]||(l[1]=u=>y.value=u),width:"500px",title:"请选择选择支付方式"},{default:t(()=>[e(le,{activeKey:x.value,"onUpdate:activeKey":l[0]||(l[0]=u=>x.value=u),type:"card",onTabClick:te},{default:t(()=>[e(N,{key:"1",tab:"微信支付"},{default:t(()=>[s("h2",null,"支付金额："+p(z.value)+" 元",1),e(q,{value:A.value,color:"#52c41a"},null,8,["value"]),at,nt]),_:1}),e(N,{key:"2",tab:"支付宝支付"},{default:t(()=>[s("h2",null,"支付金额："+p(z.value)+" 元",1),L.value?(n(),w(q,{key:0,value:B.value,color:"#1677ff"},null,8,["value"])):S("",!0),L.value?S("",!0):(n(),f("div",lt,[e(ne,{type:"primary",onClick:J},{default:t(()=>[rt]),_:1})])),it,ct]),_:1})]),_:1},8,["activeKey"])]),_:1},8,["open"]),e(Ae),e(ie)],64)}}};export{es as default};
