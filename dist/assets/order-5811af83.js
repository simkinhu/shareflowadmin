import{a as h}from"./axios-fa38e072.js";import{_ as L}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-50d1b805.js";import{u as P}from"./usershare-32ed4ae5.js";import{s as U}from"./pinia-2f8cef2e.js";import{d as z,r as i,o as N,k as A,W as o,_ as p,c as F,X as _,Y as v,a3 as d,G as V,F as M,a4 as u}from"./@vue-c9a03ce3.js";import{m as R}from"./ant-design-vue-a7ef973d.js";import"./@multiavatar-b28f2a65.js";import"./ChatBc-abd90dc1.js";import"./vuetify-3df09d96.js";import"./crypto-js-74ece96e.js";import"./vue-demi-71ba0ef2.js";import"./@babel-86619d60.js";import"./@ant-design-32a4e489.js";import"./@ctrl-044b369f.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./@emotion-f7664732.js";import"./stylis-5efc5547.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-ef06c517.js";import"./dom-align-529d0cdc.js";import"./lodash-es-5af3e9d7.js";import"./dayjs-c0c7802c.js";import"./async-validator-dee29e8b.js";import"./throttle-debounce-87e7e444.js";const $={key:0},J={key:1},O={key:2},D={key:4},G={key:5},fe=z({setup(Q){const y=P(),{isLogin:x}=U(y),s=i([]),g=i(0),l=i(1),c=i(10),f=i(new Map),k=async(e=1,n=10)=>{const m=window.VITE_API_BASE_URL;try{const t=await h.post(m+`/app/user/order?page=${e}&size=${n}`,{},{withCredentials:!0});t.data.code===1?(s.value=t.data.data.list||[],g.value=t.data.data.total||0):(s.value=[],console.error("请求错误:",t.data.message))}catch(t){s.value=[],console.error("请求错误:",t)}},I=async()=>{const e=window.VITE_API_BASE_URL;try{const n=await h.post(e+"/app/user/svip",{},{withCredentials:!0});n.data.code===1?n.data.data.forEach(t=>{f.value.set(t.id,t.package_name)}):console.error("请求错误:",n.data.message)}catch(n){console.error("请求错误:",n)}};N(()=>{JSON.parse(localStorage.getItem("isLogin")||"false")||(R.warning("您还未登录，请先登录"),y.loginModal=!0)}),A(()=>{x.value?(k(l.value,c.value),I()):s.value=[]});function w(e){return e===1?"微信支付":e===2?"支付宝支付":"第三方支付"}function S(e){return e===1?"已支付":e===0?"未支付":e}const C=i({title:"订单历史"}),T=[{text:"系统主页",href:"/"},{text:"订单历史",href:"/user/order",disabled:!0}],b=[{title:"UserToken",dataIndex:"user_token",key:"user_token"},{title:"订单号",dataIndex:"order_no",key:"order_no"},{title:"创建时间",dataIndex:"pay_datatime",key:"pay_datatime"},{title:"激活套餐",dataIndex:"product_id",key:"product_id"},{title:"支付金额",dataIndex:"payment_amount",key:"payment_amount"},{title:"支付状态",dataIndex:"payment_status",key:"payment_status"},{title:"支付渠道",dataIndex:"payment_type",key:"payment_type"},{title:"支付时间",dataIndex:"payment_completed_at",key:"payment_completed_at",width:210}],B=e=>{l.value=e.current,c.value=e.pageSize,k(l.value,c.value)};return(e,n)=>{const m=u("a-tag"),t=u("a-table"),E=u("a-empty");return o(),p(M,null,[F(L,{title:C.value.title,breadcrumbs:T},null,8,["title"]),s.value&&s.value.length>0?(o(),_(t,{key:0,columns:b,"data-source":s.value,"row-key":"id",scroll:{x:"max-content",y:"calc(100vh - 200px)"},pagination:{total:g.value,current:l.value,pageSize:c.value,showSizeChanger:!0,showQuickJumper:!0},onChange:B},{bodyCell:v(({column:r,record:a})=>[r.dataIndex==="pay_datatime"?(o(),p("span",$,d(a.pay_datatime?a.pay_datatime.replace("T"," "):""),1)):r.dataIndex==="payment_completed_at"?(o(),p("span",J,d(a.payment_completed_at?a.payment_completed_at.replace("T"," "):"未支付"),1)):r.dataIndex==="product_id"?(o(),p("span",O,d(f.value.get(a.product_id)||"未知套餐"),1)):r.dataIndex==="payment_status"?(o(),_(m,{key:3,color:a.payment_status===1?"green":"red"},{default:v(()=>[V(d(S(a.payment_status)),1)]),_:2},1032,["color"])):r.dataIndex==="payment_type"?(o(),p("span",D,d(w(a.payment_type)),1)):(o(),p("span",G,d(a[r.dataIndex]),1))]),_:1},8,["data-source","scroll","pagination"])):(o(),_(E,{key:1,description:"暂无数据"}))],64)}}});export{fe as default};
