import{i as x}from"../index-962db1df.js";import{_ as $}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-598769be.js";import{u as F}from"./userShare-c9b2675c.js";import{m as u,M}from"./ant-design-vue-84efdadc.js";import{d as N,r as s,o as E,k as O,aS as _,aJ as n,a8 as I,c as v,a9 as J,bl as y,a6 as g,b2 as f,G as w,F as R}from"./@vue-7e44e6dd.js";import{h as D}from"./@ant-design-05eaf6fc.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";import"./pinia-98ec2995.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-0e41780a.js";import"./dayjs-c3e478c5.js";import"./@multiavatar-7283d2b3.js";import"./axios-6f43ddff.js";import"./vuetify-574a8d14.js";/* empty css             */import"./vue3-apexcharts-fb146ff1.js";import"./vue-fdaf27ce.js";import"./apexcharts-a35677a7.js";import"./core-js-40ace11a.js";import"./@ctrl-044b369f.js";import"./@babel-692ca2d6.js";import"./resize-observer-polyfill-3d106987.js";import"./@emotion-f7664732.js";import"./stylis-5efc5547.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-ef06c517.js";import"./dom-align-529d0cdc.js";import"./lodash-es-5af3e9d7.js";import"./async-validator-dee29e8b.js";import"./throttle-debounce-87e7e444.js";import"./ChatBc-abd90dc1.js";import"./crypto-js-3b32aad8.js";const K={class:"redeem-section"},Q=w(" 立即兑换 "),Z={key:0},j=w(f("已绑定激活")),q={key:3},H=N({setup(W){const S=F(),B=s({title:"卡卷中心"}),L=[{text:"系统主页",href:"/"},{text:"卡卷中心",href:"/user/cardline",disabled:!0}],r=s([]),m=s(0),d=s(1),l=s(10),c=s(""),b=s({}),h=async(e,a)=>{try{const o=window.VITE_API_BASE_URL,t=await x.post(o+`/app/user/cdklist?page=${e}&size=${a}`);t.data.code===1&&t.data.data.list?(r.value=t.data.data.list,m.value=t.data.data.total,k.value.current=e,k.value.pageSize=a,k.value.total=t.data.data.total):(r.value=[],m.value=0)}catch{r.value=[],m.value=0}};async function z(){const e=/^[a-zA-Z0-9]+$/;if(!c.value||!e.test(c.value)){u.warning("请输入正确的兑换码，您输入的兑换码类型有误！");return}M.confirm({title:()=>"使用提醒：",icon:()=>v(D),content:()=>"您确定使用该兑换码进行激活吗？该兑换码使用过后不可再次使用！",centered:!0,async onOk(){const a=window.VITE_API_BASE_URL;try{const t=(await x.post(a+"/app/user/cdkeyus",{cdkcode:c.value})).data.data;t.code==200&&(u.success(t.msg,5),h(d.value,l.value),c.value=""),t.code===400&&u.error(t.msg)}catch(o){console.log(o)}},onCancel(){return u.warning("您已取消兑换码使用，如需使用请提交兑换！"),!1},zIndex:9999})}const T=async()=>{try{const e=window.VITE_API_BASE_URL,a=await x.post(e+"/app/user/svip");a.data.code===1?a.data.data.forEach(t=>{b.value[t.id]=t.package_name}):console.error("Error fetching packages:",a.data.message)}catch(e){console.error(e)}};E(()=>{h(d.value,l.value),T()});const U=e=>{d.value=e.current,l.value=e.pageSize,h(d.value,l.value)},A=[{title:"ID",dataIndex:"id",key:"id"},{title:"兑换码",dataIndex:"cdkey_code",key:"cdkey_code"},{title:"创建时间",dataIndex:"cdkey_cretetime",key:"cdkey_cretetime"},{title:"激活时间",dataIndex:"cdkey_activetime",key:"cdkey_activetime"},{title:"用户Token",dataIndex:"cdkey_usertoken",key:"cdkey_usertoken"},{title:"激活套餐",dataIndex:"cdkey_bound",key:"cdkey_bound"},{title:"激活状态",dataIndex:"cdkey_status",key:"cdkey_status"}],k=s({current:d.value,pageSize:l.value,total:m.value,showTotal:e=>`总共 ${e} 条`,showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:["10","20","30","40"]});return E(()=>{JSON.parse(localStorage.getItem("isLogin")||"false")||(u.warning("您还未登录，清先登录！"),S.loginModal=!0)}),O(()=>{S.isLogin||(r.value=[])}),(e,a)=>{const o=_("a-input"),t=_("a-button"),C=_("a-tag"),P=_("a-table"),V=_("a-empty");return n(),I(R,null,[v($,{title:B.value.title,breadcrumbs:L},null,8,["title"]),J("div",K,[v(o,{value:c.value,"onUpdate:value":a[0]||(a[0]=i=>c.value=i),placeholder:"请输入兑换码",style:{width:"300px","margin-right":"10px"}},null,8,["value"]),v(t,{class:"cdkbutton",onClick:z},{default:y(()=>[Q]),_:1})]),r.value.length>0?(n(),g(P,{key:0,columns:A,dataSource:r.value,pagination:k.value,onChange:U,scroll:{x:"max-content",y:"calc(100vh - 200px)"},rowKey:"id"},{bodyCell:y(({column:i,text:p})=>[i.dataIndex==="cdkey_cretetime"||i.dataIndex==="cdkey_activetime"?(n(),I("span",Z,f(p.replace("T"," ")),1)):i.dataIndex==="cdkey_bound"?(n(),g(C,{key:1,color:p?"green":"red"},{default:y(()=>[w(f(b.value[p]||"未知套餐"),1)]),_:2},1032,["color"])):i.dataIndex==="cdkey_status"?(n(),g(C,{key:2,color:p?"green":"red"},{default:y(()=>[j]),_:2},1032,["color"])):(n(),I("span",q,f(p),1))]),_:1},8,["dataSource","pagination","scroll"])):(n(),g(V,{key:1,description:"暂无数据"}))],64)}}});const Te=G(H,[["__scopeId","data-v-daf62d45"]]);export{Te as default};
