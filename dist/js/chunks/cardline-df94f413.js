import{i as E}from"../index-451927d2.js";import{_ as z}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-c8f847d6.js";import{u as $}from"./userShare-3887ce2e.js";import{b as w,I as P,x as j,J as D,l as F,C as B}from"./vuetify-c962898f.js";import{E as G,m as v,M as J}from"./ant-design-vue-32902922.js";import{d as O,r as m,j as Q,o as Z,aS as V,aJ as a,a8 as s,c as o,a9 as n,bl as l,a6 as y,F as _,aQ as g,b2 as x,a7 as q,G as h,u as S}from"./@vue-7e44e6dd.js";import{h as H}from"./@ant-design-bd925dbd.js";import{_ as K}from"./_plugin-vue_export-helper-c27b6911.js";import"./pinia-98ec2995.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-0e41780a.js";import"./dayjs-9df2e3b6.js";import"./@multiavatar-7283d2b3.js";import"./axios-6f43ddff.js";/* empty css             */import"./vue3-apexcharts-fb146ff1.js";import"./vue-fdaf27ce.js";import"./apexcharts-a35677a7.js";import"./core-js-40ace11a.js";import"./@babel-8a290753.js";import"./@ctrl-044b369f.js";import"./resize-observer-polyfill-3d106987.js";import"./@emotion-f7664732.js";import"./stylis-5efc5547.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-ef06c517.js";import"./dom-align-529d0cdc.js";import"./lodash-es-5af3e9d7.js";import"./async-validator-dee29e8b.js";import"./throttle-debounce-87e7e444.js";import"./ChatBc-abd90dc1.js";import"./crypto-js-3b32aad8.js";const W={class:"redeem-section mb-3"},X=h(" 立即兑换 "),Y=h("已激活"),ee=O({setup(te){const U=G.PRESENTED_IMAGE_SIMPLE;$();const A=m({title:"卡卷中心"}),M=[{text:"系统主页",href:"/"},{text:"卡卷中心",href:"/user/cardline",disabled:!0}],i=m([]),b=m(0),c=m(1),k=m(10),d=m(""),L=Q(()=>Math.ceil(b.value/k.value)),I=async(u=1,r=10)=>{const p=window.VITE_API_BASE_URL;try{const[t]=await Promise.all([E.post(p+`/app/user/cdklist?page=${u}&size=${r}`)]);t.data.code===1?(i.value=t.data.data.list||[],b.value=t.data.data.total||0):(i.value=[],console.error("请求错误:",t.data.message))}catch(t){i.value=[],console.error("请求错误:",t)}};async function N(){const u=/^[a-zA-Z0-9]+$/;if(!d.value||!u.test(d.value)){v.warning("请输入正确的兑换码，您输入的兑换码类型有误！");return}J.confirm({title:()=>"使用提醒：",icon:()=>o(H),content:()=>"您确定使用该兑换码进行激活吗？该兑换码使用过后不可再次使用！",centered:!0,async onOk(){const r=window.VITE_API_BASE_URL;try{const t=(await E.post(r+"/app/user/cdkeyus",{cdkcode:d.value})).data.data;t.code==200&&(v.success(t.msg,5),I(c.value,k.value),d.value=""),t.code===400&&v.error(t.msg)}catch(p){console.log(p)}},onCancel(){return v.warning("您已取消兑换码使用，如需使用请提交兑换！"),!1},zIndex:9999})}Z(()=>{I(c.value,k.value)});const C=[{title:"兑换码",dataIndex:"cdkey_code",key:"cdkey_code"},{title:"激活用户",dataIndex:"user",key:"user"},{title:"激活时间",dataIndex:"cdkey_activetime",key:"cdkey_activetime"},{title:"激活状态",dataIndex:"cdkey_status",key:"cdkey_status"},{title:"激活套餐",dataIndex:"package_name",key:"package_name"}],R=u=>{c.value=u,I(c.value,k.value)};return(u,r)=>{const p=V("a-input"),t=V("a-button"),T=V("a-empty");return a(),s(_,null,[o(z,{title:A.value.title,breadcrumbs:M},null,8,["title"]),n("div",W,[o(p,{value:d.value,"onUpdate:value":r[0]||(r[0]=e=>d.value=e),placeholder:"请输入兑换码",style:{width:"300px","margin-right":"10px"}},null,8,["value"]),o(t,{class:"cdkbutton",onClick:N},{default:l(()=>[X]),_:1})]),i.value&&i.value.length>0?(a(),y(B,{key:0,elevation:"10"},{default:l(()=>[o(P,null,{default:l(()=>[n("thead",null,[n("tr",null,[(a(),s(_,null,g(C,e=>n("th",{key:e.title},x(e.title),1)),64))])]),n("tbody",null,[(a(!0),s(_,null,g(i.value,e=>(a(),s("tr",{key:e.id},[(a(),s(_,null,g(C,f=>n("td",{key:f.key},[f.dataIndex==="cdkey_status"?(a(),y(w,{key:0,color:e.cdkey_activetime!=null?"green":"red"},{default:l(()=>[Y]),_:2},1032,["color"])):q("",!0),f.dataIndex==="package_name"?(a(),y(w,{key:1,color:e.package_name!=null?"green":"red"},{default:l(()=>[h(x(e.package_name),1)]),_:2},1032,["color"])):(a(),s(_,{key:2},[h(x(e[f.dataIndex]),1)],64))])),64))]))),128))])]),_:1}),o(F,{justify:"center"},{default:l(()=>[o(j,{cols:"12"},{default:l(()=>[o(D,{modelValue:c.value,"onUpdate:modelValue":[r[1]||(r[1]=e=>c.value=e),R],length:S(L)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})):(a(),y(B,{key:1,elevation:"10"},{default:l(()=>[o(P,null,{default:l(()=>[n("thead",null,[n("tr",null,[(a(),s(_,null,g(C,e=>n("th",{key:e.title},x(e.title),1)),64))])])]),_:1}),o(T,{image:S(U)},null,8,["image"])]),_:1}))],64)}}});const Ne=K(ee,[["__scopeId","data-v-bff83286"]]);export{Ne as default};
