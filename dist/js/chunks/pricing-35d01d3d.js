import{u as H}from"./usershare-8bcf8ad9.js";import{a as U}from"./axios-6f43ddff.js";import{l as ue}from"./loginChat-10b6fb73.js";import{u as de}from"../index-4b2f845e.js";import{m as g,M as pe}from"./ant-design-vue-0eeed0f5.js";import{d as _e,aS as m,aJ as n,a6 as w,bl as t,c as e,bn as me,a9 as s,r as c,w as he,o as fe,l as ge,a8 as h,u as f,b2 as _,G as b,a7 as S,F as z,aQ as N,aT as ve}from"./@vue-7e44e6dd.js";import{_ as ye}from"./_plugin-vue_export-helper-c27b6911.js";import{p as T,z as k,i as ke,b as F,D as R,n as we,f as xe,e as Ce,k as j}from"./vuetify-574a8d14.js";import{a as be,b as Se}from"./@ant-design-05eaf6fc.js";import"./pinia-98ec2995.js";import"./vue-demi-71ba0ef2.js";import"./@multiavatar-7283d2b3.js";import"./crypto-js-3b32aad8.js";import"./vue-router-0e41780a.js";import"./dayjs-8a436f85.js";/* empty css             */import"./vue3-apexcharts-fb146ff1.js";import"./vue-fdaf27ce.js";import"./apexcharts-a35677a7.js";import"./core-js-40ace11a.js";import"./@ctrl-044b369f.js";import"./@babel-692ca2d6.js";import"./resize-observer-polyfill-3d106987.js";import"./@emotion-f7664732.js";import"./stylis-5efc5547.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-ef06c517.js";import"./dom-align-529d0cdc.js";import"./lodash-es-5af3e9d7.js";import"./async-validator-dee29e8b.js";import"./throttle-debounce-87e7e444.js";const Ie="/list/assets/profilebg-44563d8e.jpg",Ae=_e({setup(){return{userStore:H()}},data(){return{usercdkInput:""}},methods:{cdkModeluse(){if(!this.userStore.isLogin)return g.warning("请先登录，再进行卡密兑换"),!1;let i=this.usercdkInput;if(!i||!/^[a-zA-Z0-9]+$/.test(i)){g.warning("请输入正确的兑换码，您输入的兑换码类型有误！");return}pe.confirm({title:()=>"使用提醒：",content:()=>"您确定使用该兑换码进行激活吗？该兑换码使用过后不可再次使用！",centered:!0,onOk:()=>{const x=window.VITE_API_BASE_URL;U.post(x+"/app/user/cdkeyus",{cdkcode:i},{withCredentials:!0}).then(a=>{const v=a.data.data;v.code==200?(this.userStore.CdkeyModal=!1,g.success(v.msg,5),this.usercdkInput=""):v.code===400&&g.error(v.msg)}).catch(a=>{console.log(a)})},onCancel(){return g.warning("您已取消兑换码使用，如需使用请提交兑换！"),!1},zIndex:99999999})}}});function Be(i,r,x,a,v,E){const y=m("a-alert"),A=m("a-input"),B=m("a-modal");return n(),w(B,{style:{top:"40%"},"z-index":"1009",footer:null,open:i.userStore.CdkeyModal,"onUpdate:open":r[2]||(r[2]=u=>i.userStore.CdkeyModal=u),width:"350px",title:"CDKEY兑换开通"},{default:t(()=>[e(y,{class:"mt-3",message:"请输入您的CDKEY兑换码进行兑换",type:"warning"}),e(A,{class:"mt-5",value:i.usercdkInput,"onUpdate:value":r[0]||(r[0]=u=>i.usercdkInput=u),placeholder:"请输入您的CDKEY兑换码",onKeyup:me(i.cdkModeluse,["enter"])},null,8,["value","onKeyup"]),s("button",{class:"mt-5 loginbutton",onClick:r[1]||(r[1]=(...u)=>i.cdkModeluse&&i.cdkModeluse(...u))},"立即使用")]),_:1},8,["open"])}const Le=ye(Ae,[["render",Be]]);const Ue=["src"],Me={class:"text-center top-spacer"},Pe={class:"avatar-border"},Ve=["innerHTML"],ze={key:0,class:"text-h5 mt-5"},Te=b("点击登录"),Fe={key:1,class:"mt-6"},Ee=s("span",{class:"text-h6 font-weight-regular"},"UserToken",-1),De={class:"text-h5"},Ke={class:"px-4 py-1"},$e=s("h6",{class:"text-h6 mt-1"},"会员类型",-1),Oe={key:0,class:"mt-1"},qe=s("h6",{class:"text-h6 mt-1"},"对话窗口",-1),Ne={class:"text-h6 mt-2"},Re=s("h6",{class:"text-h6 mt-1"},"会员到期",-1),je={class:"text-h6 mt-2"},He=s("h6",{class:"text-h6 mt-1"},"注册时间",-1),Ye={class:"text-h6 mt-2"},Je=s("h6",{class:"text-h6 mt-1"},"最后登录",-1),Ge={class:"text-h6 mt-2"},Qe={class:"d-flex justify-space-between"},We=["textContent"],Ze=["src"],Xe={class:"d-flex align-center mt-4"},et={key:0,class:"text-h6 mt-n3 pr-2"},tt={key:1,class:"display-1"},st={key:2,class:"text-medium-emphasis font-weight-medium mt-4 ml-2"},ot={key:3,class:"text-medium-emphasis font-weight-medium ml-2"},at=b("立即购买"),nt=b("立即兑换"),lt=s("h4",null,"请使用手机打开微信扫一扫",-1),rt=s("h3",{style:{"font-weight":"bold"}},"使用微信支付开通Plus会员",-1),ct={key:1,style:{width:"160px",height:"160px",padding:"60px 0",margin:"0 auto"}},it=b("点击新窗口支付"),ut=s("h4",null,"请使用手机打开支付宝扫一扫",-1),dt=s("h3",{style:{"font-weight":"bold"}},"使用支付宝支付开通Plus会员",-1),Rt={setup(i){const r=de(),x=c("1"),a=H(),v=c([]),E=c(!1),y=c(!1),A=c(null),B=c(null),u=c(null),M=c(null),L=c(!0),I=c(!1),Y=c(String(r.getSetting("siteTitle")||""));c("CheckOutlined");const J={CheckOutlined:be,CloseOutlined:Se};function G(o){return J[o]||null}const Q=async()=>{try{const o=window.VITE_API_BASE_URL,l=await U.post(`${o}/app/user/svip`);v.value=l.data.data}catch(o){console.error("请求错误:",o)}},W=()=>{a.loginModal=!0},D=()=>{const o=navigator.userAgent.toLowerCase();return/mobile|android|touch|webos|hpwos/.test(o)?"mobile":"pc"},K=async o=>{try{const l=window.VITE_API_BASE_URL,d=await U.post(`${l}/app/user/pay`,{paytype:o,package_id:$.value,device_type:D()},{withCredentials:!0});if(d.data.data.type==="error")return g.warn("支付错误请联系管理员："+d.data.data.msg,5),!1;d.data.data.type==="qrcode"?o==="1"?A.value=d.data.data.codeurl:o==="2"&&D()==="pc"&&(B.value=d.data.data.codeurl,L.value=!0):d.data.data.type==="url"&&(M.value=d.data.data.payurl,L.value=!1);const C=d.data.data.orderno;clearInterval(u.value),X(C)}catch(l){console.error("请求错误:",l)}},Z=()=>{M.value&&window.open(M.value,"_blank")},X=o=>{u.value=setInterval(()=>{ee(o)},2e3)},ee=async o=>{try{const l=window.VITE_API_BASE_URL;(await U.post(`${l}/app/user/paystatus`,{orderno:o},{withCredentials:!0})).data.data.code==="ok"?(clearInterval(u.value),g.success("支付成功，已为您开通对应会员资格"),a.fetchUserData(a.userToken),y.value=!1):console.log("Payment not completed yet.")}catch(l){console.error("请求错误:",l)}},$=c(0),P=c(0),te=o=>{if($.value=o.id,P.value=o.package_price,!a.isLogin)return g.warning("您还未登录，请先登录"),a.loginModal=!0,!1;y.value=!0,K(x.value)},se=()=>{a.CdkeyModal=!0},oe=o=>{x.value=o,y.value&&K(o)};return he(y,o=>{!o&&u.value&&clearInterval(u.value)}),fe(async()=>{if(await r.loadSettingsFromAPI(),Q(),a.fetchUserData(null),console.log(Y.value),JSON.parse(localStorage.getItem("isLogin")||"false")||(g.warning("您还未登录，清先登录！"),a.loginModal=!0),console.log(r.getSetting("paymentSwitch")),r.getSetting("paymentSwitch")){const l=new URL(window.location.href).hostname,d=r.getSetting("domainAddress"),C=r.getSetting("navSwitchAll");console.log(l),console.log(C),l===d||C===!1?I.value=!0:I.value=!1}}),ge(()=>{u.value&&clearInterval(u.value)}),(o,l)=>{const d=m("crown-icon"),C=m("message-circle-icon"),ae=m("calendar-event-icon"),ne=m("history-icon"),le=m("calendar-time-icon"),O=m("a-qrcode"),q=m("a-tab-pane"),re=m("a-button"),ce=m("a-tabs"),ie=m("a-modal");return n(),h(z,null,[e(R,{elevation:"10",class:"overflow-hidden"},{default:t(()=>[s("img",{src:f(Ie),alt:"profile",class:"w-100"},null,8,Ue),s("div",null,[e(T,{class:"mt-1"},{default:t(()=>[e(k,{cols:"12",lg:"2",sm:"12",class:"d-flex justify-center order-sml-first"},{default:t(()=>[s("div",Me,[s("div",Pe,[e(ke,{size:"100",class:"userImage"},{default:t(()=>[s("div",{innerHTML:f(a).userAvatar,style:{width:"92px",height:"92px"}},null,8,Ve)]),_:1})]),f(a).isLogin?(n(),h("div",Fe,[Ee,s("h5",De,_(f(a).userToken),1)])):(n(),h("h5",ze,[e(F,{class:"elevation-0",variant:"elevated",onClick:W},{default:t(()=>[Te]),_:1})]))])]),_:1}),e(k,{cols:"12",lg:"10",sm:"12",class:"order-sm-second pb-10"},{default:t(()=>[s("div",Ke,[e(T,{class:"justify-center"},{default:t(()=>[e(k,{cols:"12",sm:"6",md:"4",lg:"2",class:"text-center"},{default:t(()=>[e(d,{size:"30"}),$e,f(a).isLogin?(n(),h("div",Oe,[e(F,{rounded:"md",class:"font-weight-bold",color:f(a).isPlus?"error":"success",size:"small",label:""},{default:t(()=>[b(_(f(a).isPlus?"Plus会员":"普通会员"),1)]),_:1},8,["color"])])):S("",!0)]),_:1}),e(k,{cols:"12",sm:"6",md:"4",lg:"2",class:"text-center"},{default:t(()=>[e(C,{size:"30"}),qe,s("h4",Ne,_(f(a).userCount),1)]),_:1}),e(k,{cols:"12",sm:"6",md:"4",lg:"2",class:"text-center"},{default:t(()=>[e(ae,{size:"30"}),Re,s("h4",je,_(f(a).expireTime),1)]),_:1}),e(k,{cols:"12",sm:"6",md:"4",lg:"2",class:"text-center"},{default:t(()=>[e(ne,{size:"30"}),He,s("h4",Ye,_(f(a).createTime),1)]),_:1}),e(k,{cols:"12",sm:"6",md:"4",lg:"2",class:"text-center"},{default:t(()=>[e(le,{size:"30"}),Je,s("h4",Ge,_(f(a).updateTime),1)]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1}),e(T,{class:"d-flex justify-center mt-8"},{default:t(()=>[(n(!0),h(z,null,N(v.value,p=>(n(),w(k,{cols:"12",md:"3",sm:"6",xl:"3",key:p.caption},{default:t(()=>[e(R,{elevation:"10",class:"rounded-md pa-sm-8 pa-4"},{default:t(()=>[s("div",Qe,[s("h2",{class:"text-medium-emphasis text-uppercase mb-6",textContent:_(p.package_name)},null,8,We),p.package_tag_status?(n(),w(F,{key:0,size:"small",class:"mt-sm-n4 font-weight-bold",color:"warning"},{default:t(()=>[b(_(p.package_tag),1)]),_:2},1024)):S("",!0)]),s("img",{src:p.package_image,width:"90",height:"90",alt:"icon"},null,8,Ze),s("div",Xe,[I.value?(n(),h("sup",et,"￥")):S("",!0),I.value?(n(),h("h2",tt,_(p.package_price),1)):S("",!0),E.value?(n(),h("span",st,"/年")):(n(),h("span",ot,_(p.package_days)+"天",1))]),e(we,{class:"mb-0 pl-0 bg-transparent pt-5"},{default:t(()=>[(n(!0),h(z,null,N(p.listtitle,V=>(n(),w(xe,{class:"px-0",key:V.listtitle},{default:t(()=>[e(Ce,{class:"text-body-1 d-flex align-center font-weight-medium text-medium-emphasis"},{default:t(()=>[(n(),w(ve(G(V.feature_icon)),{class:"checkicon"})),b(" "+_(V.feature_title),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024),I.value?(n(),w(j,{key:0,color:"primary",size:"large",class:"mt-6",flat:"",block:"",onClick:()=>te(p)},{default:t(()=>[at]),_:2},1032,["onClick"])):(n(),w(j,{key:1,color:"primary",size:"large",class:"mt-6",flat:"",block:"",onClick:se},{default:t(()=>[nt]),_:1}))]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(ie,{bodyStyle:"paybox","z-index":"9999",footer:null,centered:"true",open:y.value,"onUpdate:open":l[1]||(l[1]=p=>y.value=p),width:"500px",title:"请选择选择支付方式"},{default:t(()=>[e(ce,{activeKey:x.value,"onUpdate:activeKey":l[0]||(l[0]=p=>x.value=p),type:"card",onTabClick:oe},{default:t(()=>[e(q,{key:"1",tab:"微信支付"},{default:t(()=>[s("h2",null,"支付金额："+_(P.value)+" 元",1),e(O,{value:A.value,color:"#52c41a"},null,8,["value"]),lt,rt]),_:1}),e(q,{key:"2",tab:"支付宝支付"},{default:t(()=>[s("h2",null,"支付金额："+_(P.value)+" 元",1),L.value?(n(),w(O,{key:0,value:B.value,color:"#1677ff"},null,8,["value"])):S("",!0),L.value?S("",!0):(n(),h("div",ct,[e(re,{type:"primary",onClick:Z},{default:t(()=>[it]),_:1})])),ut,dt]),_:1})]),_:1},8,["activeKey"])]),_:1},8,["open"]),e(Le),e(ue)],64)}}};export{Rt as default};
