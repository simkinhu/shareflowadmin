import{u as Y}from"./usershare-8bcf8ad9.js";import{a as z}from"./axios-6f43ddff.js";import{l as ce}from"./loginChat-10b6fb73.js";import{u as ie}from"../index-64e6b333.js";import{m as g,M as ue}from"./ant-design-vue-0eeed0f5.js";import{d as de,aS as _,aJ as n,a6 as w,bl as t,c as e,bn as pe,a9 as s,r as d,w as _e,o as me,l as he,a8 as h,u as f,b2 as p,G as b,a7 as S,F as P,aQ as R,aT as fe,aC as ge}from"./@vue-7e44e6dd.js";import{_ as ve}from"./_plugin-vue_export-helper-c27b6911.js";import{p as T,z as k,i as ye,b as E,D as j,n as ke,f as we,e as xe,k as H}from"./vuetify-574a8d14.js";import"./pinia-98ec2995.js";import"./vue-demi-71ba0ef2.js";import"./@multiavatar-7283d2b3.js";import"./crypto-js-3b32aad8.js";import"./vue-router-0e41780a.js";import"./dayjs-8a436f85.js";/* empty css             */import"./vue3-apexcharts-fb146ff1.js";import"./vue-fdaf27ce.js";import"./apexcharts-a35677a7.js";import"./core-js-40ace11a.js";import"./@ant-design-05eaf6fc.js";import"./@ctrl-044b369f.js";import"./@babel-692ca2d6.js";import"./resize-observer-polyfill-3d106987.js";import"./@emotion-f7664732.js";import"./stylis-5efc5547.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-ef06c517.js";import"./dom-align-529d0cdc.js";import"./lodash-es-5af3e9d7.js";import"./async-validator-dee29e8b.js";import"./throttle-debounce-87e7e444.js";const Ce="/list/assets/profilebg-44563d8e.jpg",be=de({setup(){return{userStore:Y()}},data(){return{usercdkInput:""}},methods:{cdkModeluse(){if(!this.userStore.isLogin)return g.warning("请先登录，再进行卡密兑换"),!1;let r=this.usercdkInput;if(!r||!/^[a-zA-Z0-9]+$/.test(r)){g.warning("请输入正确的兑换码，您输入的兑换码类型有误！");return}ue.confirm({title:()=>"使用提醒：",content:()=>"您确定使用该兑换码进行激活吗？该兑换码使用过后不可再次使用！",centered:!0,onOk:()=>{const x=window.VITE_API_BASE_URL;z.post(x+"/app/user/cdkeyus",{cdkcode:r},{withCredentials:!0}).then(a=>{const v=a.data.data;v.code==200?(this.userStore.CdkeyModal=!1,g.success(v.msg,5),this.usercdkInput=""):v.code===400&&g.error(v.msg)}).catch(a=>{console.log(a)})},onCancel(){return g.warning("您已取消兑换码使用，如需使用请提交兑换！"),!1},zIndex:99999999})}}});function Se(r,m,x,a,v,F){const y=_("a-alert"),A=_("a-input"),B=_("a-modal");return n(),w(B,{style:{top:"40%"},"z-index":"1009",footer:null,open:r.userStore.CdkeyModal,"onUpdate:open":m[2]||(m[2]=c=>r.userStore.CdkeyModal=c),width:"350px",title:"CDKEY兑换开通"},{default:t(()=>[e(y,{class:"mt-3",message:"请输入您的CDKEY兑换码进行兑换",type:"warning"}),e(A,{class:"mt-5",value:r.usercdkInput,"onUpdate:value":m[0]||(m[0]=c=>r.usercdkInput=c),placeholder:"请输入您的CDKEY兑换码",onKeyup:pe(r.cdkModeluse,["enter"])},null,8,["value","onKeyup"]),s("button",{class:"mt-5 loginbutton",onClick:m[1]||(m[1]=(...c)=>r.cdkModeluse&&r.cdkModeluse(...c))},"立即使用")]),_:1},8,["open"])}const Ie=ve(be,[["render",Se]]);const Ae=["src"],Be={class:"text-center top-spacer"},Le={class:"avatar-border"},Ue=["innerHTML"],ze={key:0,class:"text-h5 mt-5"},Me=b("点击登录"),Ve={key:1,class:"mt-6"},Pe=s("span",{class:"text-h6 font-weight-regular"},"UserToken",-1),Te={class:"text-h5"},Ee={class:"px-4 py-1"},Fe=s("h6",{class:"text-h6 mt-1"},"会员类型",-1),De={key:0,class:"mt-1"},Ke=s("h6",{class:"text-h6 mt-1"},"对话窗口",-1),$e={class:"text-h6 mt-2"},qe=s("h6",{class:"text-h6 mt-1"},"会员到期",-1),Ne={class:"text-h6 mt-2"},Re=s("h6",{class:"text-h6 mt-1"},"注册时间",-1),je={class:"text-h6 mt-2"},He=s("h6",{class:"text-h6 mt-1"},"最后登录",-1),Ye={class:"text-h6 mt-2"},Je={class:"d-flex justify-space-between"},Oe=["textContent"],Ge=["src"],Qe={class:"d-flex align-center mt-4"},We={key:0,class:"text-h6 mt-n3 pr-2"},Ze={key:1,class:"display-1"},Xe={key:2,class:"text-medium-emphasis font-weight-medium mt-4 ml-2"},et={key:3,class:"text-medium-emphasis font-weight-medium ml-2"},tt=b("立即购买"),st=b("立即兑换"),at=s("h4",null,"请使用手机打开微信扫一扫",-1),ot=s("h3",{style:{"font-weight":"bold"}},"使用微信支付开通Plus会员",-1),nt={key:1,style:{width:"160px",height:"160px",padding:"60px 0",margin:"0 auto"}},lt=b("点击新窗口支付"),rt=s("h4",null,"请使用手机打开支付宝扫一扫",-1),ct=s("h3",{style:{"font-weight":"bold"}},"使用支付宝支付开通Plus会员",-1),qt={setup(r){const m=ie(),x=d("1"),a=Y(),v=d([]),F=d(!1),y=d(!1),A=d(null),B=d(null),c=d(null),M=d(null),L=d(!0),I=d(!1),J=d(String(m.getSetting("siteTitle")||"")),O=async()=>{try{const o=window.VITE_API_BASE_URL,l=await z.post(`${o}/app/user/svip`);v.value=l.data.data}catch(o){console.error("请求错误:",o)}},G=()=>{a.loginModal=!0},D=()=>{const o=navigator.userAgent.toLowerCase();return/mobile|android|touch|webos|hpwos/.test(o)?"mobile":"pc"},K=async o=>{try{const l=window.VITE_API_BASE_URL,i=await z.post(`${l}/app/user/pay`,{paytype:o,package_id:$.value,device_type:D()},{withCredentials:!0});if(i.data.data.type==="error")return g.warn("支付错误请联系管理员："+i.data.data.msg,5),!1;i.data.data.type==="qrcode"?o==="1"?A.value=i.data.data.codeurl:o==="2"&&D()==="pc"&&(B.value=i.data.data.codeurl,L.value=!0):i.data.data.type==="url"&&(M.value=i.data.data.payurl,L.value=!1);const C=i.data.data.orderno;clearInterval(c.value),W(C)}catch(l){console.error("请求错误:",l)}},Q=()=>{M.value&&window.open(M.value,"_blank")},W=o=>{c.value=setInterval(()=>{Z(o)},2e3)},Z=async o=>{try{const l=window.VITE_API_BASE_URL;(await z.post(`${l}/app/user/paystatus`,{orderno:o},{withCredentials:!0})).data.data.code==="ok"?(clearInterval(c.value),g.success("支付成功，已为您开通对应会员资格"),a.fetchUserData(a.userToken),y.value=!1):console.log("Payment not completed yet.")}catch(l){console.error("请求错误:",l)}},$=d(0),V=d(0),X=o=>{if($.value=o.id,V.value=o.package_price,!a.isLogin)return g.warning("您还未登录，请先登录"),a.loginModal=!0,!1;y.value=!0,K(x.value)},ee=()=>{a.CdkeyModal=!0},te=o=>{x.value=o,y.value&&K(o)};return _e(y,o=>{!o&&c.value&&clearInterval(c.value)}),me(()=>{if(O(),a.fetchUserData(null),document.title=J.value,JSON.parse(localStorage.getItem("isLogin")||"false")||(g.warning("您还未登录，清先登录！"),a.loginModal=!0),m.getSetting("paymentSwitch")){const l=new URL(window.location.href).hostname,i=m.getSetting("domainAddress"),C=m.getSetting("navSwitchAll");console.log(l),console.log(C),l===i||C===!1?I.value=!0:I.value=!1}}),he(()=>{c.value&&clearInterval(c.value)}),(o,l)=>{const i=_("crown-icon"),C=_("message-circle-icon"),se=_("calendar-event-icon"),ae=_("history-icon"),oe=_("calendar-time-icon"),q=_("a-qrcode"),N=_("a-tab-pane"),ne=_("a-button"),le=_("a-tabs"),re=_("a-modal");return n(),h(P,null,[e(j,{elevation:"10",class:"overflow-hidden"},{default:t(()=>[s("img",{src:f(Ce),alt:"profile",class:"w-100"},null,8,Ae),s("div",null,[e(T,{class:"mt-1"},{default:t(()=>[e(k,{cols:"12",lg:"2",sm:"12",class:"d-flex justify-center order-sml-first"},{default:t(()=>[s("div",Be,[s("div",Le,[e(ye,{size:"100",class:"userImage"},{default:t(()=>[s("div",{innerHTML:f(a).userAvatar,style:{width:"92px",height:"92px"}},null,8,Ue)]),_:1})]),f(a).isLogin?(n(),h("div",Ve,[Pe,s("h5",Te,p(f(a).userToken),1)])):(n(),h("h5",ze,[e(E,{class:"elevation-0",variant:"elevated",onClick:G},{default:t(()=>[Me]),_:1})]))])]),_:1}),e(k,{cols:"12",lg:"10",sm:"12",class:"order-sm-second pb-10"},{default:t(()=>[s("div",Ee,[e(T,{class:"justify-center"},{default:t(()=>[e(k,{cols:"12",sm:"6",md:"4",lg:"2",class:"text-center"},{default:t(()=>[e(i,{size:"30"}),Fe,f(a).isLogin?(n(),h("div",De,[e(E,{rounded:"md",class:"font-weight-bold",color:f(a).isPlus?"error":"success",size:"small",label:""},{default:t(()=>[b(p(f(a).isPlus?"Plus会员":"普通会员"),1)]),_:1},8,["color"])])):S("",!0)]),_:1}),e(k,{cols:"12",sm:"6",md:"4",lg:"2",class:"text-center"},{default:t(()=>[e(C,{size:"30"}),Ke,s("h4",$e,p(f(a).userCount),1)]),_:1}),e(k,{cols:"12",sm:"6",md:"4",lg:"2",class:"text-center"},{default:t(()=>[e(se,{size:"30"}),qe,s("h4",Ne,p(f(a).expireTime),1)]),_:1}),e(k,{cols:"12",sm:"6",md:"4",lg:"2",class:"text-center"},{default:t(()=>[e(ae,{size:"30"}),Re,s("h4",je,p(f(a).createTime),1)]),_:1}),e(k,{cols:"12",sm:"6",md:"4",lg:"2",class:"text-center"},{default:t(()=>[e(oe,{size:"30"}),He,s("h4",Ye,p(f(a).updateTime),1)]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1}),e(T,{class:"d-flex justify-center mt-8"},{default:t(()=>[(n(!0),h(P,null,R(v.value,u=>(n(),w(k,{cols:"12",md:"3",sm:"6",xl:"3",key:u.caption},{default:t(()=>[e(j,{elevation:"10",class:"rounded-md pa-sm-8 pa-4"},{default:t(()=>[s("div",Je,[s("h2",{class:"text-medium-emphasis text-uppercase mb-6",textContent:p(u.package_name)},null,8,Oe),u.package_tag_status?(n(),w(E,{key:0,size:"small",class:"mt-sm-n4 font-weight-bold",color:"warning"},{default:t(()=>[b(p(u.package_tag),1)]),_:2},1024)):S("",!0)]),s("img",{src:u.package_image,width:"90",alt:"icon"},null,8,Ge),s("div",Qe,[I.value?(n(),h("sup",We,"￥")):S("",!0),I.value?(n(),h("h2",Ze,p(u.package_price),1)):S("",!0),F.value?(n(),h("span",Xe,"/年")):(n(),h("span",et,p(u.package_days)+"天",1))]),e(ke,{class:"mb-0 pl-0 bg-transparent pt-5"},{default:t(()=>[(n(!0),h(P,null,R(u.listtitle,U=>(n(),w(we,{class:"px-0",key:U.listtitle},{default:t(()=>[e(xe,{class:"text-body-1 d-flex align-center font-weight-medium text-medium-emphasis"},{default:t(()=>[(n(),w(fe(U.feature_icon),{class:ge(["text-"+U.feature_color,"mr-4"]),"stroke-width":"2",size:"18"},null,8,["class"])),b(" "+p(U.feature_title),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024),I.value?(n(),w(H,{key:0,color:"primary",size:"large",class:"mt-6",flat:"",block:"",onClick:()=>X(u)},{default:t(()=>[tt]),_:2},1032,["onClick"])):(n(),w(H,{key:1,color:"primary",size:"large",class:"mt-6",flat:"",block:"",onClick:ee},{default:t(()=>[st]),_:1}))]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(re,{bodyStyle:"paybox","z-index":"9999",footer:null,centered:"true",open:y.value,"onUpdate:open":l[1]||(l[1]=u=>y.value=u),width:"500px",title:"请选择选择支付方式"},{default:t(()=>[e(le,{activeKey:x.value,"onUpdate:activeKey":l[0]||(l[0]=u=>x.value=u),type:"card",onTabClick:te},{default:t(()=>[e(N,{key:"1",tab:"微信支付"},{default:t(()=>[s("h2",null,"支付金额："+p(V.value)+" 元",1),e(q,{value:A.value,color:"#52c41a"},null,8,["value"]),at,ot]),_:1}),e(N,{key:"2",tab:"支付宝支付"},{default:t(()=>[s("h2",null,"支付金额："+p(V.value)+" 元",1),L.value?(n(),w(q,{key:0,value:B.value,color:"#1677ff"},null,8,["value"])):S("",!0),L.value?S("",!0):(n(),h("div",nt,[e(ne,{type:"primary",onClick:Q},{default:t(()=>[lt]),_:1})])),rt,ct]),_:1})]),_:1},8,["activeKey"])]),_:1},8,["open"]),e(Ie),e(ce)],64)}}};export{qt as default};
