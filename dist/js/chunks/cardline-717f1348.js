import{i as E}from"../index-4f413245.js";import{_ as z}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-5d13d757.js";import{u as $}from"./userShare-d029cad9.js";import{w as C,L as F,l as j,B as S,b as B,I as P,J as D,C as b}from"./vuetify-e7ea846c.js";import{E as G,m as y,M as J}from"./ant-design-vue-32902922.js";import{d as O,r as p,j as K,o as Q,aS as Z,aJ as o,a8 as n,c as t,bl as a,a6 as v,a9 as l,F as m,aQ as g,b2 as I,a7 as q,G as x,u as M,aM as H,aK as W}from"./@vue-7e44e6dd.js";import{h as X}from"./@ant-design-bd925dbd.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";import"./pinia-98ec2995.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-0e41780a.js";import"./dayjs-9df2e3b6.js";import"./@multiavatar-7283d2b3.js";import"./axios-00de4f6f.js";/* empty css             */import"./vue3-apexcharts-fb146ff1.js";import"./vue-fdaf27ce.js";import"./apexcharts-a35677a7.js";import"./core-js-40ace11a.js";import"./@babel-8a290753.js";import"./@ctrl-044b369f.js";import"./resize-observer-polyfill-3d106987.js";import"./@emotion-f7664732.js";import"./stylis-5efc5547.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-ef06c517.js";import"./dom-align-529d0cdc.js";import"./lodash-es-5af3e9d7.js";import"./async-validator-dee29e8b.js";import"./throttle-debounce-87e7e444.js";import"./ChatBc-abd90dc1.js";import"./crypto-js-3b32aad8.js";const ee=_=>(H("data-v-caf88593"),_=_(),W(),_),te=x(" 立即兑换 "),ae=x("已激活"),oe=ee(()=>l("div",{class:"pt-3"},null,-1)),le=O({setup(_){const U=G.PRESENTED_IMAGE_SIMPLE;$();const A=p({title:"卡卷中心"}),L=[{text:"系统主页",href:"/"},{text:"卡卷中心",href:"/user/cardline",disabled:!0}],r=p([]),w=p(0),d=p(1),f=p(10),c=p(""),T=K(()=>Math.ceil(w.value/f.value)),V=async(i=1,s=10)=>{const u=window.VITE_API_BASE_URL;try{const[e]=await Promise.all([E.post(u+`/app/user/cdklist?page=${i}&size=${s}`)]);e.data.code===1?(r.value=e.data.data.list||[],w.value=e.data.data.total||0):(r.value=[],console.error("请求错误:",e.data.message))}catch(e){r.value=[],console.error("请求错误:",e)}};async function N(){const i=/^[a-zA-Z0-9]+$/;if(!c.value||!i.test(c.value)){y.warning("请输入正确的兑换码，您输入的兑换码类型有误！");return}J.confirm({title:()=>"使用提醒：",icon:()=>t(X),content:()=>"您确定使用该兑换码进行激活吗？该兑换码使用过后不可再次使用！",centered:!0,async onOk(){const s=window.VITE_API_BASE_URL;try{const e=(await E.post(s+"/app/user/cdkeyus",{cdkcode:c.value})).data.data;e.code==200&&(y.success(e.msg,5),V(d.value,f.value),c.value=""),e.code===400&&y.error(e.msg)}catch(u){console.log(u)}},onCancel(){return y.warning("您已取消兑换码使用，如需使用请提交兑换！"),!1},zIndex:9999})}Q(()=>{V(d.value,f.value)});const h=[{title:"兑换码",dataIndex:"cdkey_code",key:"cdkey_code"},{title:"激活用户",dataIndex:"user",key:"user"},{title:"激活时间",dataIndex:"cdkey_activetime",key:"cdkey_activetime"},{title:"激活状态",dataIndex:"cdkey_status",key:"cdkey_status"},{title:"激活套餐",dataIndex:"package_name",key:"package_name"}],R=i=>{d.value=i,V(d.value,f.value)};return(i,s)=>{const u=Z("a-empty");return o(),n(m,null,[t(z,{title:A.value.title,breadcrumbs:L},null,8,["title"]),t(S,null,{default:a(()=>[t(C,{cols:"8",md:"4"},{default:a(()=>[t(F,{modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=e=>c.value=e),label:"请输入兑换码",outlineddensity:"compact",dense:""},null,8,["modelValue"])]),_:1}),t(C,{cols:"4",md:"8",style:{"margin-top":"5px"}},{default:a(()=>[t(j,{color:"primary",depressed:"","full-width":"",onClick:N},{default:a(()=>[te]),_:1})]),_:1})]),_:1}),r.value&&r.value.length>0?(o(),v(b,{key:0,elevation:"10"},{default:a(()=>[t(P,null,{default:a(()=>[l("thead",null,[l("tr",null,[(o(),n(m,null,g(h,e=>l("th",{key:e.title},I(e.title),1)),64))])]),l("tbody",null,[(o(!0),n(m,null,g(r.value,e=>(o(),n("tr",{key:e.id},[(o(),n(m,null,g(h,k=>l("td",{key:k.key},[k.dataIndex==="cdkey_status"?(o(),v(B,{key:0,color:e.cdkey_activetime!=null?"green":"red"},{default:a(()=>[ae]),_:2},1032,["color"])):q("",!0),k.dataIndex==="package_name"?(o(),v(B,{key:1,color:e.package_name!=null?"green":"red"},{default:a(()=>[x(I(e.package_name),1)]),_:2},1032,["color"])):(o(),n(m,{key:2},[x(I(e[k.dataIndex]),1)],64))])),64))]))),128))])]),_:1}),t(S,{justify:"center"},{default:a(()=>[t(C,{cols:"12"},{default:a(()=>[t(D,{modelValue:d.value,"onUpdate:modelValue":[s[1]||(s[1]=e=>d.value=e),R],length:M(T)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})):(o(),v(b,{key:1,elevation:"10"},{default:a(()=>[t(P,null,{default:a(()=>[l("thead",null,[l("tr",null,[(o(),n(m,null,g(h,e=>l("th",{key:e.title},I(e.title),1)),64))])])]),_:1}),t(u,{image:M(U)},null,8,["image"]),oe]),_:1}))],64)}}});const ze=Y(le,[["__scopeId","data-v-caf88593"]]);export{ze as default};
