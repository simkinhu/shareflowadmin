import{u as a}from"./userShare-4a70d299.js";import{u as n}from"../index-a145e6cf.js";import{d as i,r as u,o as l}from"./@vue-7e44e6dd.js";import{m as t}from"./ant-design-vue-32902922.js";const h=i({setup(){const e=a(),s=n(),r=u(0);return l(async()=>{await s.loadSettingsFromAPI(),r.value=Number(s.getSetting("new_user_days"))}),{userStore:e,newuserdays:r}},data(){return{useremail:"",password:""}},methods:{async userlogin(){const e=this.useremail||null,s=this.password||null;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return t.warning("请输入有效的电子邮箱"),!1;if(this.password.length<8){t.warning("用户密码必须大于8位字符，请重新输入");return}if(!s)return t.warning("请输入您的账户密码"),!1;try{await this.userStore.fetchUserData(e,s)?(this.userStore.loginModal=!1,t.success("登录成功"),this.useremail=null,this.password=null,this.calculateDaysBetween()):t.error("登录失败，请检查您的账户和密码")}catch(o){console.error("登录错误:",o),t.error("登录过程中出现错误")}},registModel(){this.userStore.registModel=!0,this.userStore.loginModal=!1},passModel(){this.userStore.passModel=!0,this.userStore.loginModal=!1},calculateDaysBetween(){const e=new Date,r=new Date(this.userStore.expireTime).getTime()-e.getTime();this.userStore.daysBetween=Math.floor(r/(1e3*60*60*24)),this.userStore.expired=this.userStore.daysBetween<=0}}});export{h as _};
